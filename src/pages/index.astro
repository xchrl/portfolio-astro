---
import Layout from "../layouts/Layout.astro";
import { FaDiscord } from "react-icons/fa";
import { GrLocation } from "react-icons/gr";
import Clock from "@/components/Clock.astro";
import ProjectCard from "@/components/ProjectCard";
import { BsPerson } from "react-icons/bs";
import { Separator } from "@/components/ui/separator";
import avatar from "@/assets/avatar.jpg";
import { contactInfo } from "@/data/contact";
import { fetchRepos, fetchLanguageColors } from "@/lib/github";
import { Image } from "astro:assets";

const data = await fetchRepos(Astro);
const colors = await fetchLanguageColors();
const url = new URL("/api/github", Astro.url).toString();
---

<Layout>
  <div class="flex flex-col gap-2 md:gap-8">
    <!-- Avatar -->
    <div class="h-4 lg:h-8 relative">
      <Image
        src={avatar}
        alt="Avatar"
        class="w-24 lg:w-42 absolute bottom-0 left-0 right-0 mx-auto md:mx-0 rounded-full border-2 md:border-4 border-accent hover:scale-110 duration-150"
        loading="eager"
      />
    </div>
    <!-- Hero section -->
    <div>
      <h1>
        ðŸ‘‹ hey hey, i'm <span class="text-gradient" id="title"></span>
      </h1>
      <h4 class="text-muted-foreground">front-end dev</h4>
    </div>
    <div>
      <p>
        i'm a self-taught front-end developer that's incredibly passionate about
        programming and ui development.
      </p>
      <p>
        i'm also really into gaming (especially gacha games), esports (mainly
        counter strike and rocket league), a little bit of speedcubing and
        keyboard modding.
      </p>
    </div>
    <div
      class="flex flex-col lg:flex-row items-center justify-center md:items-start lg:items-center gap-4 lg:gap-8"
    >
      <div class="flex items-center gap-3">
        <div class="border border-accent p-2 rounded-sm">
          <BsPerson />
        </div>
        <span>he/him</span>
      </div>
      <div class="flex flex-row items-center gap-3">
        <div class="border border-accent p-2 rounded-sm">
          <GrLocation />
        </div>
        <span>przemyÅ›l, poland</span>
      </div>
      <Clock />
      <span
        class="bg-green-600/20 px-4 py-2 border border-green-600 rounded-md md:ml-auto text-center"
      >
        available for internships/work/commissions
      </span>
    </div>
  </div>
  <Separator />
  <!-- Contact -->
  <div class="flex flex-col gap-4 text-center md:text-start">
    <h2>you can find me on social media:</h2>
    <ul class="flex flex-col gap-4">
      <li
        class="flex flex-col md:flex-row gap-y-2 items-center justify-between"
      >
        <div class="flex items-center gap-3 text-xl">
          <FaDiscord />
          <h4>discord</h4>
        </div>
        <iframe
          title="Discord user embed"
          width="340"
          height="72"
          sandbox="allow-scripts"
          src="https://widgets.vendicated.dev/user?id=329597208494211073&theme=light&banner=false&full-banner=false&rounded-corners=true&discord-icon=true&badges=false&guess-nitro=false&"
          class="block dark:hidden hover:scale-110 duration-150 max-w-full"
        ></iframe>
        <iframe
          title="Discord user embed"
          width="340"
          height="72"
          sandbox="allow-scripts"
          src="https://widgets.vendicated.dev/user?id=329597208494211073&theme=dark&banner=false&full-banner=false&rounded-corners=true&discord-icon=true&badges=false&guess-nitro=false&"
          class="hidden dark:block hover:scale-110 duration-150 max-w-full"
        ></iframe>
      </li>
      {
        contactInfo.map(({ type, name, link, Icon }) => (
          <li class="flex flex-col md:flex-row gap-2 items-center justify-between">
            <div class="flex items-center gap-3 text-xl">
              <Icon />
              <h4>{type}</h4>
            </div>
            <a
              href={link}
              class="px-3 rounded-full bg-muted border border-accent/40 hover:text-background hover:bg-accent hover:scale-110 duration-150"
              target="_blank"
            >
              {name}
            </a>
          </li>
        ))
      }
    </ul>
  </div>
  <Separator />
  <!-- Projects -->
  <div class="flex flex-col gap-4">
    <h2 class="text-center md:text-start">
      here's some of the <span class="text-accent">projects</span> i've worked on:
    </h2>
    <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4">
      <ProjectCard url={url} client:visible />
    </div>
  </div>
</Layout>
<script>
  import Typed from "typed.js";

  document.addEventListener("astro:after-swap", startTyped);
  document.addEventListener("DOMContentLoaded", startTyped);

  function startTyped() {
    new Typed("#title", {
      strings: ["xchrl!", "charlie!"],
      showCursor: false,
      backSpeed: 160,
      typeSpeed: 160,
      backDelay: 2000,
      startDelay: 500,
      loop: true,
    });
  }
</script>
